{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-09-08T11:12:35.381243Z", "invocation_id": "c24c66db-a6a2-4ee4-98f3-6651dc536f73", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-08T11:12:13.033941Z", "completed_at": "2024-09-08T11:12:13.055528Z"}, {"name": "execute", "started_at": "2024-09-08T11:12:13.055883Z", "completed_at": "2024-09-08T11:12:18.083993Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.051478624343872, "adapter_response": {"_message": "CREATE TABLE (4.4k rows, 11.1 MiB processed)", "code": "CREATE TABLE", "rows_affected": 4380, "bytes_processed": 11591218, "bytes_billed": 20971520, "location": "US", "project_id": "dbt-project-431506", "job_id": "22f4702b-bd92-4974-8b5b-1bcd616a86a2", "slot_ms": 4571}, "message": "CREATE TABLE (4.4k rows, 11.1 MiB processed)", "failures": null, "unique_id": "model.retail.dim_customer", "compiled": true, "compiled_code": "-- dim_customer.sql\n\n-- create customer dimension table\n\nWITH customer_cte AS (\n    SELECT DISTINCT\n        to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) AS customer_id,\n        Country as country\n    FROM `dbt-project-431506`.`retail`.`raw_invoices`\n    WHERE CustomerID IS NOT NULL\n)\nSELECT t.*, cm.iso\nFROM customer_cte t\nLEFT JOIN `dbt-project-431506`.`retail`.`country` cm\nON t.country = cm.nicename", "relation_name": "`dbt-project-431506`.`retail`.`dim_customer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-08T11:12:18.089324Z", "completed_at": "2024-09-08T11:12:18.092475Z"}, {"name": "execute", "started_at": "2024-09-08T11:12:18.092817Z", "completed_at": "2024-09-08T11:12:23.196034Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.107595443725586, "adapter_response": {"_message": "CREATE TABLE (23.3k rows, 7.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 23260, "bytes_processed": 8117969, "bytes_billed": 10485760, "location": "US", "project_id": "dbt-project-431506", "job_id": "c5dca48e-665e-4b12-9023-b58354580acc", "slot_ms": 4267}, "message": "CREATE TABLE (23.3k rows, 7.7 MiB processed)", "failures": null, "unique_id": "model.retail.dim_datetime", "compiled": true, "compiled_code": "-- dim_datetime.sql\n\n-- Create datetime dimension table\n\nWITH datetime_cte AS (\n    SELECT DISTINCT InvoiceDate AS datetime_id,\n    CASE\n        WHEN LENGTH(InvoiceDate) = 16 THEN\n            -- Format datetime as: \"MM/DD/YYYY HH:MM\"\n            PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)\n        WHEN LENGTH(InvoiceDate) <= 14 THEN\n            -- Format datetime as: \"MM/DD/YY HH:MM\"\n            PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)\n        ELSE\n            NULL\n        END AS processed_datetime\n    FROM `dbt-project-431506`.`retail`.`raw_invoices`\n    WHERE InvoiceDate IS NOT NULL\n)\nSELECT datetime_id,\nprocessed_datetime AS datetime,\nEXTRACT(YEAR FROM processed_datetime) AS year,\nEXTRACT(MONTH FROM processed_datetime) AS month,\nEXTRACT(DAY FROM processed_datetime) AS day,\nEXTRACT(HOUR FROM processed_datetime) AS hour,\nEXTRACT(MINUTE FROM processed_datetime) AS min,\nEXTRACT(DAYOFWEEK FROM processed_datetime) AS weekday\nFROM datetime_cte", "relation_name": "`dbt-project-431506`.`retail`.`dim_datetime`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-08T11:12:23.199198Z", "completed_at": "2024-09-08T11:12:23.202392Z"}, {"name": "execute", "started_at": "2024-09-08T11:12:23.202639Z", "completed_at": "2024-09-08T11:12:27.930031Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.731444358825684, "adapter_response": {"_message": "CREATE TABLE (16.3k rows, 22.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 16282, "bytes_processed": 23656403, "bytes_billed": 24117248, "location": "US", "project_id": "dbt-project-431506", "job_id": "8262a4bb-5f31-494c-81ac-0547b1b9af63", "slot_ms": 4364}, "message": "CREATE TABLE (16.3k rows, 22.6 MiB processed)", "failures": null, "unique_id": "model.retail.dim_product", "compiled": true, "compiled_code": "-- dim_product.sql\n\n-- Create product table dimension with UnitPrice > 0\n\n-- StockCode is not unique, that mean a product with a same id can have different price.\n\nSELECT DISTINCT\n    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) AS product_id,\n    StockCode AS stock_code,\n    Description AS description,\n    UnitPrice AS unit_price\nFROM `dbt-project-431506`.`retail`.`raw_invoices`\nWHERE StockCode IS NOT NULL\nAND UnitPrice > 0", "relation_name": "`dbt-project-431506`.`retail`.`dim_product`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-08T11:12:27.932863Z", "completed_at": "2024-09-08T11:12:27.937908Z"}, {"name": "execute", "started_at": "2024-09-08T11:12:27.938108Z", "completed_at": "2024-09-08T11:12:35.371028Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.4388346672058105, "adapter_response": {"_message": "CREATE TABLE (397.9k rows, 50.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 397884, "bytes_processed": 53090798, "bytes_billed": 53477376, "location": "US", "project_id": "dbt-project-431506", "job_id": "5d1b0e65-3b72-40d7-b403-610088fa059a", "slot_ms": 8948}, "message": "CREATE TABLE (397.9k rows, 50.6 MiB processed)", "failures": null, "unique_id": "model.retail.fct_invoices", "compiled": true, "compiled_code": "-- Create the fact table for invoices by joining the relevant keys from dimension tables\n\nWITH fct_invoices_cte AS (\n    SELECT\n        InvoiceNo AS invoice_id,\n        InvoiceDate AS datetime_id,\n        to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) AS product_id,\n        to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) AS customer_id,\n        Quantity AS quantity,\n        Quantity * UnitPrice AS total\n    FROM\n        `dbt-project-431506`.`retail`.`raw_invoices`\n    WHERE\n        Quantity > 0\n)\nSELECT\n    invoice_id,\n    dt.datetime_id,\n    dp.product_id,\n    dc.customer_id,\n    quantity,\n    total\nFROM fct_invoices_cte fi\nINNER JOIN `dbt-project-431506`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id\nINNER JOIN `dbt-project-431506`.`retail`.`dim_product` dp ON fi.product_id = dp.product_id\nINNER JOIN `dbt-project-431506`.`retail`.`dim_customer` dc ON fi.customer_id = dc.customer_id", "relation_name": "`dbt-project-431506`.`retail`.`fct_invoices`"}], "elapsed_time": 23.67182946205139, "args": {"log_format_file": "debug", "version_check": true, "partial_parse_file_diff": true, "log_level_file": "debug", "defer": false, "exclude": [], "quiet": false, "use_colors_file": true, "send_anonymous_usage_stats": true, "show_resource_report": false, "log_level": "info", "macro_debugging": false, "log_file_max_bytes": 10485760, "project_dir": "/usr/local/airflow/include/dbt", "warn_error_options": {"include": [], "exclude": []}, "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "printer_width": 80, "write_json": true, "cache_selected_only": false, "invocation_command": "dbt run --profiles-dir . --select path:models/transform", "require_resource_names_without_spaces": false, "favor_state": false, "log_path": "/usr/local/airflow/include/dbt/logs", "populate_cache": true, "use_colors": true, "which": "run", "enable_legacy_logger": false, "print": true, "profiles_dir": ".", "static_parser": true, "introspect": true, "log_format": "default", "source_freshness_run_project_hooks": false, "indirect_selection": "eager", "select": ["path:models/transform"], "empty": false, "partial_parse": true, "strict_mode": false}}